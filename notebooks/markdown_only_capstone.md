"# **Loan Default Prediction**"
"## **Problem Definition**\n"
"\n"
"### **The Context:**\n"
"\n"
"Loan defaults pose a significant threat to a bank’s financial health. For instance, while the mortgage delinquency rate in the United States has been gradually declining since the COVID-19 pandemic, as of February 2024, the overall delinquency rate was 2.8%. Such non-performing assets (NPAs) erode profitability and constrain the bank’s ability to extend new credit. Moreover, the manual loan approval process is labor-intensive and susceptible to human errors and biases, leading to potential misjudgments in loan approvals or rejections. Addressing this issue is crucial to enhance operational efficiency, reduce financial risks, and uphold equitable lending practices.\n"
"\n"
"### **The objective:**\n"
"\n"
"The goal is to modernize and streamline the loan approval process by leveraging machine learning classification methods, capable of as accurately predicting loan defaults as possible using available data. This model should:\n"
" - Enhance operational efficiency by automating repetitive tasks and reducing the time spent on manual credit assessments.\n"
" - Mitigate risk by identifying high-risk applicants before loan issuance.\n"
" - Ensure fairness by eliminating biases that could disadvantage certain demographics, thus aligning with federal regulation, legal requirements and ethical standards.\n"
" - Ensure Regulatory Compliance by aligning with legal frameworks such as the Equal Credit Opportunity Act, which mandates non-discriminatory lending practices and requires transparent justifications for adverse decisions.\n"
" - Enable data-driven decision-making by providing interpretable insights into why a loan is approved or rejected, allowing for greater transparency and trust with stakeholders.\n"
" - Promote Fairness by eliminating biases inherent in human judgment, ensuring equitable treatment of all applicants.\n"
" - The model should be extensible to learn from future loan defaults\n"
"\n"
"### **The key questions:**\n"
"\n"
" - Which applicants are likely to default on their loans? Identifying potential defaulters enables targeted risk management strategies.\n"
" - What factors are most critical in assessing an applicant’s creditworthiness? Determining key indicators such as income stability, debt-to-income ratio, and credit history informs more accurate evaluations.\n"
" - How can the loan approval process be optimized for efficiency and fairness? Implementing automated, data-driven systems can streamline operations while upholding ethical standards.\n"
" - How can the model ensure compliance with regulatory requirements? Providing interpretable justifications for loan decisions is essential to meet legal obligations and maintain transparency.\n"
" - How can historical biases be prevented from influencing the model? Ensuring the model is trained on unbiased data is crucial to avoid perpetuating past discriminatory practices.\n"
"\n"
"### **The problem formulation**:\n"
"\n"
"Data science enables us to:\n"
" - Predict defaults: Use predictive analytics to assess the likelihood of applicants failing to meet their repayment obligations.\n"
" - Automate Decision-Making: Replace subjective human assessments with objective, data-driven evaluations, enhancing consistency and speed.\n"
" - Identify Key Risk Factors: Analyze data to pinpoint variables that significantly influence default risk, such as high debt-to-income ratios or unstable employment histories.\n"
" - Ensure Model Interpretability: Develop transparent models that provide clear explanations for their decisions, facilitating compliance with regulations and building stakeholder trust.\n"
" - Mitigate Bias: Implement fairness algorithms to detect and correct biases, ensuring the model’s decisions are equitable and just.\n"
"\n"
"By solving this problem, the bank not only reduces risk but also transforms its loan approval system into a benchmark for innovation and inclusivity."
"## **Data Description:**\n"
"The Home Equity dataset (HMEQ) contains baseline and loan performance information for 5,960 recent home equity loans. The target (BAD) is a binary variable that indicates whether an applicant has ultimately defaulted or has been severely delinquent. This adverse outcome occurred in 1,189 cases (20 percent). 12 input variables were registered for each applicant.\n"
"\n"
"\n"
"* **BAD:** 1 = Client defaulted on loan, 0 = loan repaid\n"
"\n"
"* **LOAN:** Amount of loan approved.\n"
"\n"
"* **MORTDUE:** Amount due on the existing mortgage.\n"
"\n"
"* **VALUE:** Current value of the property. \n"
"\n"
"* **REASON:** Reason for the loan request. (HomeImp = home improvement, DebtCon= debt consolidation which means taking out a new loan to pay off other liabilities and consumer debts) \n"
"\n"
"* **JOB:** The type of job that loan applicant has such as manager, self, etc.\n"
"\n"
"* **YOJ:** Years at present job.\n"
"\n"
"* **DEROG:** Number of major derogatory reports (which indicates a serious delinquency or late payments). \n"
"\n"
"* **DELINQ:** Number of delinquent credit lines (a line of credit becomes delinquent when a borrower does not make the minimum required payments 30 to 60 days past the day on which the payments were due). \n"
"\n"
"* **CLAGE:** Age of the oldest credit line in months. \n"
"\n"
"* **NINQ:** Number of recent credit inquiries. \n"
"\n"
"* **CLNO:** Number of existing credit lines.\n"
"\n"
"* **DEBTINC:** Debt-to-income ratio (all your monthly debt payments divided by your gross monthly income. This number is one way lenders measure your ability to manage the monthly payments to repay the money you plan to borrow."
"## **Import the necessary libraries and Data**"
"## **Data Overview**\n"
"- Reading the dataset\n"
"- Understanding the shape of the dataset\n"
"- Checking the data types\n"
"- Checking for missing values\n"
"- Checking for duplicated values"
"#### Let's check any inconsitencies in the data"
"#### Observations\n"
"1. Dataset contains several missing values. These need to be treated individually as the use of summary statistic may not be appropriate or sufficient for this this dataset i.e. morgage_amount_due can have missing values,but loan_request_reason or property_current_value cannot be. Also many of the missing values may depend on values in other columns, such as major_derogatory_report, delinquent_credit_lines, recent_credit_inquiries, existing_credit_lines and debt_to_income_ratio are all correlated\n"
"2. Features like debt_to_income_ratio and major_derogatory_reports have significant missing values (21.3% and 11.9%, respectively)\n"
"4. Dataset has 5960 rows and 13 columns (12 independant features)\n"
"5. Data is for approved loans only, as there are no missing values in the loan_amount_approved\n"
"6. No duplicate records, which is understandable, as most individuals or families requesting for loan are unique\n"
"7. All categorical values look clean - no typos, unique values and consistent labeling\n"
"8. Many of the features should be integrers, but are floats in the dataset - major_derogatory_reports, delinquent_credir_lines, recent_credit_inquiries and existing_credit_lines. If the actual values, indeed are floats, its a data descripency which should be addresses before further processing\n"
"9. Proportion of defaulting client is 20%, which is too high by industry standards, indicating a highly biased dataset\n"
"10. Several records had a very high loan to value ratio. This is quite unusual. All the records with ltv > 2.0 were dropped\n"
"11. Also, the features applicant job type and years at present job, may invite discimatory litigation (class action lawsuits)!"
"## Summary Statistics"
"#### Observations\n"
"\n"
"1. Skewness: major_derogatory_reports, delinquent_credit_lines, debt_to_income_ratio are concentrated near zero with a long tail, indicating skewness\n"
"2. Outliers: mortgage_amount_due, property_current_value, age_of_oldest_credit_line, and debt_to_income_ratio extreme high max values, with 75% percentile closer to the mean, indicating outliers.\n"
"\n"
"Vizualization of the distributions of these features will provide clarity on these observations."
"## **Exploratory Data Analysis (EDA) and Visualization**"
"- EDA is an important part of any project involving data.\n"
"- It is important to investigate and understand the data better before building a model with it.\n"
"- A few questions have been mentioned below which will help you approach the analysis in the right manner and generate insights from the data.\n"
"- A thorough analysis of the data, in addition to the questions mentioned below, should be done."
"**Leading Questions**:\n"
"1. What is the range of values for the loan amount variable \"LOAN\"?\n"
"2. How does the distribution of years at present job \"YOJ\" vary across the dataset?\n"
"3. How many unique categories are there in the REASON variable?\n"
"4. What is the most common category in the JOB variable?\n"
"5. Is there a relationship between the REASON variable and the proportion of applicants who defaulted on their loan?\n"
"6. Do applicants who default have a significantly different loan amount compared to those who repay their loan?\n"
"7. Is there a correlation between the value of the property and the loan default rate?\n"
"8. Do applicants who default have a significantly different mortgage amount compared to those who repay their loan?"
"### **Data prep for EDA and subsequent processing**"
"#### Missing value treatement\n"
"I have used techniques from recommandation systems to impute the missing values **(Reference: \"Missing Data: A Gentle Introduction\" by Patrick E. McKnight, Katherine M. McKnight, Souraya Sidani, and Aurelio José Figueredo)**. Below is a summary of methods used for imputatation\n"
"\n"
"**1. KNN Imputation (Low/Moderate Missingness)**\n"
"\n"
"* mortgage_amount_due, property_current_value, loan_request_reason, applicant_job_type, age_of_oldest_credit_line, existing_credit_line columns have less than 10% missing values. KNN imputation is effective for low-to-moderate missingness by finding similar rows based on available features and averaging/matching the corresponding feature values.\n"
"\n"
"**2. Iterative Imputer (High Missingness)**\n"
"\n"
"* debt_to_income_ratio, major_derogatory_reports, delinquentt_credit_line, years_at_present_job, recent_credit_inquirie columns have higher missing percentages (10–21%). Iterative imputation models each feature as a function of the others, iteratively predicting missing values to best fit the observed data.\n"
"\n"
"**3. Encoding for Categorical Data**\n"
"\n"
"* loan_request_reason, applicant_job_type columns contain categorical data. They were encoded using LabelEncoder to convert string values into numeric categories, allowing compatibility with KNN imputer."
"#### Prepare data for EDA"
"### **Univariate Analysis**\n"
"#### Observation:\n"
"Mortgage amount due shows a slightly right skewed distribution, but with a lot of outliers. These may need to be treated based on the type of modelling technique used for modeling"
"#### Observation:\n"
"Current property value shows a slightly right skewed distribution, but with a lot of outliers. These may need to be treated based on the type of modelling technique used for modeling"
"#### Observation:\n"
"No of years at present job shows a moderately right skewed, multi-modal distribution, with a few outliers, indicating most loan requesters maybe in middle age group. Extreme outliers may have to be capped"
"#### Observations:\n"
"Major derogatory reports shows a highly right skewed distribution, with most values around zero. This may indicate a bias in the prescreening process"
"#### Observations:\n"
"Delinquent credit lines shows a highly right skewed distribution, with most values around zero. This may indicate a bias in the prescreening process"
"#### Observation:\n"
"Oldest credit line shows fairly uniform bi-modal distribution, with quite a few outliers. What maybe of interest here are the loan requesters with low or zero age of credit line. Also extreme outliers may have to be capped"
"#### Observations:\n"
"Recent credit inquiries shows a highly right skewed distribution, with most values around zero. This may indicate a bias in the prescreening process"
"#### Observations:\n"
"Existing credit lines shows a reasonably uniform distribution with slight right tail and a few outliers. Extreme outliers may need to be capped"
"#### Observations:\n"
"Debt to income ratio is slightly left skewed, with outliers on both sides. Extreme outlier on the high may need capping. Left skewness is a good thing as a low debt to income ratio is desirable\n"
"The distribution is also showing a sharp drop around ~ 40. Should investigate this further"
"#### Observation:\n"
"Amount of loan approved shows a slightly right skewed distribution, but with a lot of outliers. These may need to be treated based on the type of modelling technique used for modeling"
"#### Observations:\n"
"1. ~ 70% of requests are for debt consolidation, indication a fundamental bias in the dataset, or biased selection process\n"
"2. Majority (~ 45%) of the loan requests are from people who did not provide details of the profession, suggesting improvements in the data collection process"
"### **Bivariate Analysis**"
"### Check correlation for numeric variables"
"#### Observations:\n"
"1. Property value as of date seems to have a strong +ve correlation to mortgage amount due. This is only possible if all if the mortgages in the dataset were approved around the same time and the approved mortgage amount was a fixed % of the property value, irrespective of other factors. So age of the mortgage may be a useful feature (latent variable). Most other variables have weak correlations"
"#### Let's check the distribution of numerical variables to loan defaults"
"#### Observations\n"
"1. No of defaulters are highest where recent credit inquiries, delinquent credit lines, major derogatory reports are the lowest. This seems counter intuitive at first, how ever this is most likely due to these customers not having any credit records at all. This will happen if these customers were denied credit in the past and have not applied for credit in the recent time (for the duration during which this data was collected). Additional data is required to understand this anamoly - gross income, demographics, macroeconomic factors such severe recession or other financial distress\n"
"2. Default rate is the extra-ordinarily high (80%) for customers with debt to income ratio between 30-41. Understanding this anomaly likely requires a more detailed analysis of the borrower behavior and external conditions. This data set is insufficient for such analysis, as was commented in no 1 above"
"#### Let's check the distribution of categorical variables to loan defaults"
"#### Observations:\n"
"1. As expected, loan defaults are higher for clients who requested loan for debt consolidation, as these clients already had substantial debt and most likely not enough income to cover the debt\n"
"2. Applicants with job type as 'other' have the highest default rate. This may be because these clients do not have a steady job and as such chose not to disclose it. Also the higher default rate for 'Mgr' and 'ProfExe' is interesting and may need further analysis"
"#### Observation:\n"
"1. All the available features are significant for the prediction of target variable\n"
"2. Also, features related to clients credit posture seem to have higher significance, which is expected"
"#### Observation:\n"
"current property value shows a very high correlation with mortgage amount due, which is expected. These should be replaced with an engineered feature. Additional insights can be gained from priniciple component analysis"
"### **Multivariate Analysis**"
"#### Multivariate analysis using PCA"
"#### Prep the data for PCA"
"#### Observation\n"
"There is no single component which can be attributed with a large variance in the dataset"
"Let's check the contribution of each of the original features to the principle components"
"#### Create a new feature to replace Mortgage due and property value as they are highly correlated, and check if it impacts the PCs"
"#### Observations\n"
"Based on PCA analysis, it is clear that replacing 'mortgage_amount_due', 'property_current_value' by 'mortgage_to_property_ratio' will not impact modelling performance"
"## Treating Outliers\n"
"Only the outliers for mortgage due and property value have been dropped, where the ratio of these features was improbable. See section to 1.4.0.1. All the other outliers are maintained as is as they seem to be realistic data points"
"## Treating Missing Values: See section 1.6.1.1"
"## **Important Insights from EDA**\n"
"\n"
"### Key Data Insights for Classification\n"
"\n"
"#### Handling Missing Values\n"
"- Critical features like `loan_request_reason` and `property_current_value` must have no missing values as they are essential for predicting loan defaults.\n"
"- Features like `major_derogatory_reports` and `debt_to_income_ratio` (with missing rates of 11.9% and 21.3%) require imputation or exclusion based on their impact.\n"
"\n"
"#### Dataset Characteristics\n"
"- **Records**: 5960 with no duplicates.\n"
"- **Default Rate**: High (20%), indicating no class imbalance but potential dataset biases.\n"
"- **Target Variable**: Well-defined (`loan_default`).\n"
"\n"
"#### Potential Predictors\n"
"- Features such as `debt_to_income_ratio`, `major_derogatory_reports`, `recent_credit_inquiries`, and `existing_credit_lines` are likely predictive but require normalization and outlier treatment.\n"
"\n"
"#### Feature Engineering\n"
"- Replace correlated variables (`mortgage_amount_due` and `property_current_value`) with `mortgage_to_property_ratio`.\n"
"- Consider creating latent features such as \"age of mortgage\" or \"credit history duration\" for added predictive power.\n"
"\n"
"#### Skewness and Outliers\n"
"- Many numerical features (e.g., `debt_to_income_ratio`, `mortgage_amount_due`) are right-skewed with significant outliers.\n"
"- Apply transformations and outlier capping to improve model robustness.\n"
"\n"
"#### Bias and Feature Validity\n"
"- Categorical variables like `applicant_job_type` and `loan_request_reason` show inherent bias (e.g., 70% of loans are for debt consolidation).\n"
"- Features like `job_type` and `years_at_present_job` may raise ethical or legal concerns.\n"
"\n"
"#### Class Separation and Patterns\n"
"- Default rates are high for clients with minimal credit records or specific debt-to-income ranges (30–41%).\n"
"- This highlights actionable risk segments.\n"
"\n"
"---\n"
"\n"
"### Key Statistical Insights\n"
"\n"
"#### Correlations\n"
"- Strong correlation between `property_current_value` and `mortgage_amount_due` supports dimensionality reduction.\n"
"- Weak correlations across most features suggest the need for engineered features or interaction terms.\n"
"\n"
"#### Categorical Variable Impact\n"
"- High default rates for specific `job_type` categories (`other`, `Mgr`, `ProfExe`) suggest profession-based insights could improve classification if handled carefully.\n"
"\n"
"---\n"
"\n"
"### Recommendations for Modeling\n"
"\n"
"#### Preprocessing\n"
"- Treat missing values based on correlation and domain importance.\n"
"- Normalize or transform skewed features and cap outliers.\n"
"- Create engineered features (e.g., `mortgage_to_property_ratio`).\n"
"\n"
"#### Bias Mitigation\n"
"- Address potential dataset bias (e.g., over-representation of debt consolidation loans).\n"
"- Carefully handle legally sensitive features like `job_type` to avoid bias in classification.\n"
"\n"
"#### Feature Selection\n"
"- Prioritize credit-related features (`debt_to_income_ratio`, `recent_credit_inquiries`, `delinquent_credit_lines`) given their significance for predicting defaults.\n"
"\n"
"#### Advanced Analysis\n"
"- Investigate latent variables and external data (e.g., economic conditions) to explain observed anomalies in defaults."
"## **Model Building - Approach**\n"
"- Data preparation\n"
"- Partition the data into train and test set\n"
"- Build the model\n"
"- Fit on the train data\n"
"- Tune the model\n"
"- Test the model on test set"
"#### Confusion Matrix"
"<div style=\"display: inline-block\">\n"
"    \n"
"| Actual/Predicted       | Predicted: 0 (No Default) | Predicted: 1 (Default)|\n"
"|:-----------------------|:--------------------------|:----------------------|\n"
"| Actual: 0 (No Default) | True Negative (TN)        | False Positive (FP)   |\n"
"| Actual: 1 (Default)    | False Negative (FN)       | True Positive (TP)    |\n"
"\n"
"</div>"
"Classification model should maximize the expected value of the revenue from lending. In order to acheive this:\n"
"1. Maximize True Negatives - This will bring in the bulk of the interest revenue\n"
"2. Minimize False Negatives - This will reduce the interest loss due to defaulted loans (principle can be recouped via foreclosure)\n"
"3. Minimize False Positives - This will minimize the opportunity loss\n"
"To achieve this, we will define 2 functions\n"
"### Function to calculate the expected revenue:\n"
"\n"
"$\n"
"\\text{Expected Revenue} = \\text{Revenue from True Negatives (TN)} - \\text{Loss from False Positives (FP)} - \\text{Loss from False Negatives (FN)}\n"
"$\n"
"\n"
"1. Revenue from True Negatives (TN):\n"
"\n"
"$\n"
"\\text{Revenue}{\\text{TN}} = P{\\text{ND}} \\cdot (1 - \\text{Actual}) \\cdot L \\cdot r\n"
"$\n"
"Where:\n"
"\t•\t$P_{\\text{ND}} = 1 - P_{\\text{D}}$: Probability of non-default.\n"
"\t•\t$\\text{Actual}$: Indicator of the actual outcome ($0$ = non-default, $1$ = default).\n"
"\t•\t$L$: Loan amount.\n"
"\t•\t$r$: Interest rate.\n"
"\n"
"2. Loss from False Positives (FP):\n"
"\n"
"$\n"
"\\text{Loss}{\\text{FP}} = P{\\text{D}} \\cdot (1 - \\text{Actual}) \\cdot L \\cdot r\n"
"$\n"
"Where:\n"
"\t•\t$P_{\\text{D}}$: Probability of default.\n"
"\t•\t$(1 - \\text{Actual})$: Ensures the outcome is non-default ($\\text{Actual} = 0$).\n"
"\t•\t$L \\cdot r$: Opportunity cost (lost interest revenue).\n"
"\n"
"3. Loss from False Negatives (FN):\n"
"\n"
"$\n"
"\\text{Loss}{\\text{FN}} = P{\\text{ND}} \\cdot \\text{Actual} \\cdot L \\cdot (1 + r)\n"
"$\n"
"Where:\n"
"\t•\t$P_{\\text{ND}}$: Probability of non-default.\n"
"\t•\t$\\text{Actual}$: Ensures the outcome is default ($\\text{Actual} = 1$).\n"
"\t•\t$L \\cdot (1 + r)$: Total loss (principal + interest).\n"
"\n"
"Final Formula:\n"
"\n"
"$\n"
"\\text{Expected Revenue} = \\left( P_{\\text{ND}} \\cdot (1 - \\text{Actual}) \\cdot L \\cdot r \\right)\n"
"\t•\t\\left( P_{\\text{D}} \\cdot (1 - \\text{Actual}) \\cdot L \\cdot r \\right)\n"
"\t•\t\\left( P_{\\text{ND}} \\cdot \\text{Actual} \\cdot L \\cdot (1 + r) \\right)\n"
"$\n"
"\n"
"Definitions:\n"
"\t•\t$P_{\\text{D}}$: Probability of default.\n"
"\t•\t$P_{\\text{ND}} = 1 - P_{\\text{D}}$: Probability of non-default.\n"
"\t•\t$\\text{Actual}$: Binary variable ($0 = \\text{Non-default}, 1 = \\text{Default}$).\n"
"\t•\t$L$: Loan amount.\n"
"\t•\t$r$: Interest rate."
"### Logistic Regression"
"### Observation\n"
"The performance of the model on the trained data and test data is almost identical.\\\n"
"Primary driving factors are related to the -ve credit history of the client and the income.\\\n"
"Loan amount approved and existing credit lines has a negative coefficient.\\\n"
"Overall the performance of Logistic regression is not satisfactory as the recall is very low.\n"
"\n"
"**Let's see if we can improve the performance by gridsearch**"
"#### Observation:\n"
"Even GridSearch is not able to provide a satisfactory performance, as is evident from recall scores. The best recall score is the same as the model without GridSearch\n"
"\n"
"However, the best result is for the model optimized for recall\n"
"\n"
"The false positives seem to be primarily driven by credit-related factors (delinquent_credit_lines, debt_to_income_ratio, and major_derogatory_reports) overpowering stabilizing factors like small loan amounts, long credit histories, or stable job types. Addressing these imbalances in the model can improve its predictive accuracy."
"### Decision Tree"
"#### Observation:\n"
"\n"
"Model is overfitting the training data, but the performance on the test data is very good compared to Logistic Regression model\n"
"Debt to income ratio is the most important factor is default, while the delinquent credit lines was the most important for Logistic Regression\n"
"The importance of the features is in line with general expectations"
"### **Decision Tree - Hyperparameter Tuning**\n"
"\n"
"* Hyperparameter tuning is tricky in the sense that **there is no direct way to calculate how a change in the hyperparameter value will reduce the loss of your model**, so we usually resort to experimentation. We'll use Grid search to perform hyperparameter tuning.\n"
"* **Grid search is a tuning technique that attempts to compute the optimum values of hyperparameters.** \n"
"* **It is an exhaustive search** that is performed on the specific parameter values of a model.\n"
"* The parameters of the estimator/model used to apply these methods are **optimized by cross-validated grid-search** over a parameter grid.\n"
"\n"
"**Criterion {“gini”, “entropy”}**\n"
"\n"
"The function to measure the quality of a split. Supported criteria are “gini” for the Gini impurity and “entropy” for the information gain.\n"
"\n"
"**max_depth** \n"
"\n"
"The maximum depth of the tree. If None, then nodes are expanded until all leaves are pure or until all leaves contain less than min_samples_split samples.\n"
"\n"
"**min_samples_leaf**\n"
"\n"
"The minimum number of samples is required to be at a leaf node. A split point at any depth will only be considered if it leaves at least min_samples_leaf training samples in each of the left and right branches. This may have the effect of smoothing the model, especially in regression.\n"
"\n"
"You can learn about more Hyperpapameters on this link and try to tune them. \n"
"\n"
"https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html\n"
"**Observations:**\n"
"\n"
"- The tuned models are performing marginally better in comparison to the model with default values of hyperparameters.\n"
"- While these models are giving good results for recall, there is opportunity to improve the overall performance\n"
"### **Building a Random Forest Classifier**\n"
"\n"
"**Random Forest is a bagging algorithm where the base models are Decision Trees.** Samples are taken from the training data and on each sample a decision tree makes a prediction. \n"
"\n"
"**The results from all the decision trees are combined together and the final prediction is made using voting or averaging.**"
"#### Observation:\n"
"\n"
"Random forest model has a much better overall performance than decisiontree model. The feature importance for top 5 features has also changed slightly, with ltv taking precedence\n"
"Adjusting the threshold also substantially improved model performance and should be implemented for the final model as well"
"### **Random Forest Classifier Hyperparameter Tuning**"
"#### Observation:\n"
"Tuned RF models are the best-performing among all the models so far, and is giving us scores on the test dataset."
"**Model Comparision based on expected revenue and confidence level**\n"
"1. Model1 - Logistic Regression with liblinear solver: **Total expected revenue: \\$2698670.84 with confidence of: 0.84**\n"
"2. Model2 - Best Logistic Regression model with GridSearch: **Total expected revenue: \\$2694612.65 with confidence of: 0.84**\n"
"3. Model3 - Decisiontree with entropy: **Total expected revenue: \\$7501717.5 with confidence of: 1.0**\n"
"4. Model4 - Best DecisionTree model with GridSearch: **Total expected revenue: \\$7458707.5 with confidence of: 1.0**\n"
"5. Model5 - RandomForest with entropy: **Total expected revenue: \\$5562512.65485 with confidence of: 0.92**\n"
"6. Model6 - Best RandomForest with GridSearch: **Total expected revenue: \\$6651963.2723875 with confidence of: 0.97**\n"
"\n"
"**Model Comparision based on metrics**\n"
"\n"
"<div style=\"display: inline-block\">\n"
"\n"
"| **Model**                        | **Precision** | **Recall** | **F1-Score** | **Confidence** |\n"
"|----------------------------------|---------------|------------|--------------|----------------|\n"
"| **Model 1** (Logistic Regression) | 0.75          | 0.27       | 0.40         | 0.84           |\n"
"| **Model 2** (Logistic Regression, GridSearch) | 0.75 | 0.27 | 0.40 | 0.84 |\n"
"| **Model 3** (Decision Tree)       | 0.68          | 0.57       | 0.62         | 1.0            |\n"
"| **Model 4** (Decision Tree, GridSearch) | 0.63      | 0.57       | 0.60         | 1.0            |\n"
"| **Model 5** (Random Forest)       | 0.92          | 0.63       | 0.75         | 0.92           |\n"
"| **Model 6** (Random Forest, GridSearch) | 0.91     | 0.70       | 0.79         | 0.97           |\n"
"\n"
"</div>\n"
"\n"
"Overall performance is better for tree based models in comparision with logistic regression. This points to non-linearity in the dataset and existence of outliers, both of which are handled very effectievely by tree based models. \n"
"\n"
"As can be seen from the above comparision, Model 3 gives the best performance from a revenue standpoint, however, Model 6 has the best performance in terms of the metrics. This descrepency may be because Model 3 performed well against clients with higher loan values. However a more detailed analysis needs to be performed to understand the descrepency. \n"
"\n"
"There is of course room for improvement in all of the above models by fine tuning the hyperparameters to focus on reducing False Negatives (while not overly sacrificing the recall), as the cost of False Negatives is substantially higher than False positives (i.e. False negatives cost the lender the principle and the interest whereas False positives cost the lender only the interest). This can be achieved by adjusting the weights and fine tuning the threshold to penalize False Negatives more than False Positives."
"**2. Refined insights and recommandations:** \n"
"\n"
"1. Improve Data Quality and capture additional data\n"
"> - Encourage applicants to provide missing details, such as job_type and loan_request_reason\n"
"> - Use dropdowns and predefined options for categorical data like job_type to minimize typos and inconsistencies.\n"
"> - Include gross income and monthly expenses to calculate a more accurate debt-to-income ratio, as this is the most important factor in determining eligibility\n"
"> - Collect data on savings, investment portfolios, and other assets to assess overall financial stability\n"
"> - Obtain credit scores and histories from reputable bureaus to ensure a consistent, accurate representation of creditworthiness\n"
"\n"
"2. Remove bias in the dataset\n"
"> - Ensure that all demographic groups and professions are fairly represented in the data to avoid skewing results\n"
"> - Reduce overrepresentation of risky loan types (e.g., debt consolidation loans) by diversifying the dataset\n"
"\n"
"3. Business model\n"
"> - Gather borrower feedback on application processes and loan terms to identify areas for business improvement\n"
"> - Use the model to identify high-risk borrower segments (e.g., high debt-to-income ratios, multiple derogatory reports)\n"
"> - Higher interest rates or stricter loan limits for high-risk borrowers\n"
"> - Discounts or incentives for low-risk borrowers\n"
"> - Offer customized repayment options for borrowers facing temporary financial difficulties\n"
"> - Regular evaluation of bias and fairness to ensure legal and ethical compliance\n"
"\n"
"**Summary**\n"
"The loan default problem is heavily influenced by credit history, debt burden, and dataset biases (e.g., debt consolidation). \n"
"The most effective strategies will involve:\n"
"> - Robust feature engineering to balance stabilizing and risk-indicating factors.\n"
"> - Careful tuning of decision thresholds and class weights to minimize false negatives without inflating false positives."
"**3. Proposal for the final solution design:**\n"
"\n"
"While it is tempting to adopt Model 3 or Model 4, due to its performance against revenue metric, it should be noted that these models may not perform well against future customers due to poorer metrics as compared to Model 5 and Model 6.\\\n"
"So the lender should adopt a refined version of Model 6.\\\n"
"In summary, for better future default prediction, **Model6 (Random Forest with GridSearch, optimized for f1) is the best choice** due to its strong balance between recall, precision, and F1-score, along with high confidence.\\\n"
"It is most likely to perform well in minimizing both false negatives (missed defaults) and false positives (incorrect rejections).\\\n"
"The lender should also **implement the recommendations** from the section above to get the most out of predictive model on an ongoing basis which will benefit the lender in more than one ways.\n"
"> - Improve model accuracy and robustness by reducing bias and missing information\n"
"> - Ensures fair and personalized loan offerings, improving customer satisfaction\n"
"> - Reduces legal and ethical risks by eliminating discriminatory practices\n"
"> - Helps mitigate default risk and increases profitability"
